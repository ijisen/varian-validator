/*! varian-validator v0.04 | ISC © 2022 ji sen  (https://github.com/ijisen) https://github.com/ijisen/varian-validator#readme */
!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s((e="undefined"!=typeof globalThis?globalThis:e||self).Validator={})}(this,(function(e){"use strict";let s;!function(e){e.en="en-US",e.zh="zh-CN"}(s||(s={}));const t={zh:{DOMAIN_IS_EMPTY:"校验内容为空",DOMAIN_FORMAT_ERROR:"域名格式错误",DOMAIN_TOO_SHORT:"域名长度不能小于 1 个字符.",DOMAIN_TOO_LONG:"域名长度不能超过 255 个字符.",LABEL_STARTS_WITH_DASH:"域名标签不能以 . 开头.",LABEL_ENDS_WITH_DASH:"域名标签不能以 . 结尾.",LABEL_WITH_HYPHEN:"域名标签不能以 - 开头或结尾.",LABEL_TOO_LONG:"域名标签的长度最多为 63 个字符.",LABEL_TOO_SHORT:"域名标签应至少为 1 个字符长.",LABEL_WITH_UNDERSCORES:"域名标签不能包含 _ ",LABEL_ENDS_WITH_UNDERSCORES:"域名标签不能以 _ 结尾.",LABEL_INVALID_CHARS:"域名标签只能包含a-z、A-Z、0-9、-、_、.、*、@、中文汉字.",TLD_WITH_NUMBER:"TLD不能包含数字.",TLD_INVALID_CHARS:"TLD格式错误."},en:{DOMAIN_IS_EMPTY:"Check content is empty",DOMAIN_FORMAT_ERROR:"Domain name format error",DOMAIN_TOO_SHORT:"Domain name too short.",DOMAIN_TOO_LONG:"Domain name too long. It should be no more than 255 chars.",LABEL_STARTS_WITH_DASH:"Domain name label can not start with a dash.",LABEL_ENDS_WITH_DASH:"Domain name label can not end with a dash.",LABEL_WITH_HYPHEN:"Domain labels cannot start or end with -.",LABEL_TOO_LONG:"Domain name label should be at most 63 chars long.",LABEL_TOO_SHORT:"Domain name label should be at least 1 character long.",LABEL_WITH_UNDERSCORES:"Domain labels cannot contain _",LABEL_ENDS_WITH_UNDERSCORES:"Domain labels can not end with _",LABEL_INVALID_CHARS:"Domain name label can only contain a-z、A-Z、0-9、-、_、.、*、@、中文汉字.",TLD_WITH_NUMBER:"TLD cannot contain numbers",TLD_INVALID_CHARS:"TLD format error"}},n={require_tld:!0,allow_underscores:!0,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1};function a(e,a={},r){let _=t[((e=s.zh)=>e===s.en?"en":"zh")(r)];if("string"!=typeof e||""===e.replace(" ",""))return{success:!1,message:_.DOMAIN_IS_EMPTY};if(a={...n,...a},console.log(a),!e)return{success:!1,message:_.DOMAIN_TOO_SHORT};const o=e.length;if(o>255)return{success:!1,message:_.DOMAIN_TOO_LONG};a.allow_trailing_dot&&"."===e[o-1]&&(e=e.substring(0,o-1)),a.allow_wildcard&&0===e.indexOf("*.")&&(e=e.substring(2));const l=e.split(".");console.log(l);const c=l.length;if(a.require_tld){if(c<2)return{success:!1,message:_.DOMAIN_FORMAT_ERROR};if(c>127)return{success:!1,message:_.DOMAIN_FORMAT_ERROR};const e=l[c-1];if(!a.allow_numeric_tld&&/^\d+$/.test(e))return{success:!1,message:_.TLD_WITH_NUMBER};if(!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(e))return{success:!1,message:_.TLD_INVALID_CHARS}}else if(c>126)return{success:!1,message:_.DOMAIN_FORMAT_ERROR};for(let e=0;e<c;e++){const s=l[e];if(console.log(s),s.length>63)return{success:!1,message:_.LABEL_TOO_LONG};if(!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(s))return{success:!1,message:_.LABEL_INVALID_CHARS};if(/[\uff01-\uff5e]/.test(s))return{success:!1,message:_.LABEL_INVALID_CHARS};if(/^-|-$/.test(s))return{success:!1,message:_.LABEL_WITH_HYPHEN};if(!a.allow_underscores&&/_/.test(s))return{success:!1,message:_.LABEL_WITH_UNDERSCORES};if(/_$/.test(s))return{success:!1,message:_.LABEL_ENDS_WITH_UNDERSCORES}}return{success:!0,message:""}}const r=e=>a(e,{require_tld:!0,allow_underscores:!0,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1});const _="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",o=`(${_}[.]){3}${_}`,l=new RegExp(`^${o}$`),c="(?:[0-9a-fA-F]{1,4})",A=new RegExp(`^((?:${c}:){7}(?:${c}|:)|(?:${c}:){6}(?:${o}|:${c}|:)|(?:${c}:){5}(?::${o}|(:${c}){1,2}|:)|(?:${c}:){4}(?:(:${c}){0,1}:${o}|(:${c}){1,3}|:)|(?:${c}:){3}(?:(:${c}){0,2}:${o}|(:${c}){1,4}|:)|(?:${c}:){2}(?:(:${c}){0,3}:${o}|(:${c}){1,5}|:)|(?:${c}:){1}(?:(:${c}){0,4}:${o}|(:${c}){1,6}|:)|(?::((?::${c}){0,5}:${o}|(?::${c}){1,7}|:)))(%[0-9a-zA-Z-.:]{1,})?$`);var i=(e,s,t)=>{if(!((e,s=!1)=>("string"==typeof e&&(e=e.replace(/\s+/g,"")),!isNaN(e)&&""!==e&&"object"!=typeof e&&"boolean"!=typeof e&&(!((e=parseFloat(e))<0)||s)))(e))return!1;const n=Number(e);return n>=s&&n<=t};const u=(e,s)=>"string"==typeof e?(e=e.trim()).split(s||/\s+/):[];var L=e=>{const s=u(e);return 4===s.length&&i(s[0],0,65535)&&i(s[1],0,65535)&&(e=>i(e,1,65535))(s[2])&&r(s[3])};let O;!function(e){e.A="A",e.AAAA="AAAA",e.NS="NS",e.MX="MX",e.CNAME="CNAME",e.CAA="CAA",e.SRV="SRV",e.TXT="TXT"}(O||(O={}));e.Button="export default Button;",e.escape=e=>"string"==typeof e&&e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#96;"),e.isDomain=r,e.isFQDN=a,e.isRdata=(e,s)=>{switch(s.toUpperCase()){case O.A:return t=e,l.test(t);case O.AAAA:return(e=>A.test(e))(e);case O.CNAME:return r(e);case O.MX:return(e=>!!e&&r(e))(e);case O.TXT:return(e=>e.length>255)(e);case O.NS:return(e=>r(e))(e);case O.CAA:return(e=>{const s=u(e);return 3===s.length&&i(s[0],0,255)&&-1!==["issue","issuewild","iodef"].indexOf(s[1])&&/^"[\w-:./@]{1,255}"$/.test(s[2])})(e);case O.SRV:return L(e);default:return!1}var t},e.version="0.04",Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=validator.min.js.map
