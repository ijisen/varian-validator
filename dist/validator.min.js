/*! varian-validator v0.04 | ISC © 2022 ji sen  (https://github.com/ijisen) https://github.com/ijisen/varian-validator#readme */
!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports):"function"==typeof define&&define.amd?define(["exports"],s):s((e="undefined"!=typeof globalThis?globalThis:e||self).Validator={})}(this,(function(e){"use strict";const s={zh:{DOMAIN_IS_EMPTY:"校验内容为空",DOMAIN_FORMAT_ERROR:"域名格式错误",DOMAIN_TOO_SHORT:"域名长度不能小于 1 个字符.",DOMAIN_TOO_LONG:"域名长度不能超过 255 个字符.",LABEL_STARTS_WITH_DASH:"域名标签不能以 . 开头.",LABEL_ENDS_WITH_DASH:"域名标签不能以 . 结尾.",LABEL_WITH_HYPHEN:"域名标签不能以 - 开头或结尾.",LABEL_TOO_LONG:"域名标签的长度最多为 63 个字符.",LABEL_TOO_SHORT:"域名标签应至少为 1 个字符长.",LABEL_WITH_UNDERSCORES:"域名标签不能包含 _ ",LABEL_ENDS_WITH_UNDERSCORES:"域名标签不能以 _ 结尾.",LABEL_INVALID_CHARS:"域名标签只能包含a-z、A-Z、0-9、-、_、.、*、@、中文汉字.",TLD_WITH_NUMBER:"TLD不能包含数字.",TLD_INVALID_CHARS:"TLD格式错误."},en:{DOMAIN_IS_EMPTY:"Check content is empty",DOMAIN_FORMAT_ERROR:"Domain name format error",DOMAIN_TOO_SHORT:"Domain name too short.",DOMAIN_TOO_LONG:"Domain name too long. It should be no more than 255 chars.",LABEL_STARTS_WITH_DASH:"Domain name label can not start with a dash.",LABEL_ENDS_WITH_DASH:"Domain name label can not end with a dash.",LABEL_WITH_HYPHEN:"Domain labels cannot start or end with -.",LABEL_TOO_LONG:"Domain name label should be at most 63 chars long.",LABEL_TOO_SHORT:"Domain name label should be at least 1 character long.",LABEL_WITH_UNDERSCORES:"Domain labels cannot contain _",LABEL_ENDS_WITH_UNDERSCORES:"Domain labels can not end with _",LABEL_INVALID_CHARS:"Domain name label can only contain a-z、A-Z、0-9、-、_、.、*、@、中文汉字.",TLD_WITH_NUMBER:"TLD cannot contain numbers",TLD_INVALID_CHARS:"TLD format error"}},t={require_tld:!0,allow_underscores:!0,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1};function n(e,n={},a){let r=s[((e="zh-CN")=>"en-US"===e?"en":"zh")(a)];if("string"!=typeof e||""===e.replace(" ",""))return{success:!1,message:r.DOMAIN_IS_EMPTY};if(n={...t,...n},console.log(n),!e)return{success:!1,message:r.DOMAIN_TOO_SHORT};const _=e.length;if(_>255)return{success:!1,message:r.DOMAIN_TOO_LONG};n.allow_trailing_dot&&"."===e[_-1]&&(e=e.substring(0,_-1)),n.allow_wildcard&&0===e.indexOf("*.")&&(e=e.substring(2));const o=e.split(".");console.log(o);const l=o.length;if(n.require_tld){if(l<2)return{success:!1,message:r.DOMAIN_FORMAT_ERROR};if(l>127)return{success:!1,message:r.DOMAIN_FORMAT_ERROR};const e=o[l-1];if(!n.allow_numeric_tld&&/^\d+$/.test(e))return{success:!1,message:r.TLD_WITH_NUMBER};if(!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(e))return{success:!1,message:r.TLD_INVALID_CHARS}}else if(l>126)return{success:!1,message:r.DOMAIN_FORMAT_ERROR};for(let e=0;e<l;e++){const s=o[e];if(console.log(s),s.length>63)return{success:!1,message:r.LABEL_TOO_LONG};if(!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(s))return{success:!1,message:r.LABEL_INVALID_CHARS};if(/[\uff01-\uff5e]/.test(s))return{success:!1,message:r.LABEL_INVALID_CHARS};if(/^-|-$/.test(s))return{success:!1,message:r.LABEL_WITH_HYPHEN};if(!n.allow_underscores&&/_/.test(s))return{success:!1,message:r.LABEL_WITH_UNDERSCORES};if(/_$/.test(s))return{success:!1,message:r.LABEL_ENDS_WITH_UNDERSCORES}}return{success:!0,message:""}}const a=e=>n(e,{require_tld:!0,allow_underscores:!0,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1});const r="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",_=`(${r}[.]){3}${r}`,o=new RegExp(`^${_}$`),l="(?:[0-9a-fA-F]{1,4})",c=new RegExp(`^((?:${l}:){7}(?:${l}|:)|(?:${l}:){6}(?:${_}|:${l}|:)|(?:${l}:){5}(?::${_}|(:${l}){1,2}|:)|(?:${l}:){4}(?:(:${l}){0,1}:${_}|(:${l}){1,3}|:)|(?:${l}:){3}(?:(:${l}){0,2}:${_}|(:${l}){1,4}|:)|(?:${l}:){2}(?:(:${l}){0,3}:${_}|(:${l}){1,5}|:)|(?:${l}:){1}(?:(:${l}){0,4}:${_}|(:${l}){1,6}|:)|(?::((?::${l}){0,5}:${_}|(?::${l}){1,7}|:)))(%[0-9a-zA-Z-.:]{1,})?$`);var i=(e,s,t)=>{if(!((e,s=!1)=>("string"==typeof e&&(e=e.replace(/\s+/g,"")),!isNaN(e)&&""!==e&&"object"!=typeof e&&"boolean"!=typeof e&&(!((e=parseFloat(e))<0)||s)))(e))return!1;const n=Number(e);return n>=s&&n<=t};const u=(e,s)=>"string"==typeof e?(e=e.trim()).split(s||/\s+/):[];var A=e=>{const s=u(e);return 4===s.length&&i(s[0],0,65535)&&i(s[1],0,65535)&&(e=>i(e,1,65535))(s[2])&&a(s[3])};e.Button="export default Button;",e.escape=e=>"string"==typeof e&&e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#96;"),e.isDomain=a,e.isFQDN=n,e.isRdata=(e,s)=>{switch(s.toUpperCase()){case"A":return t=e,o.test(t);case"AAAA":return(e=>c.test(e))(e);case"CNAME":return a(e);case"MX":return(e=>!!e&&a(e))(e);case"TXT":return(e=>e.length>255)(e);case"NS":return(e=>a(e))(e);case"CAA":return(e=>{const s=u(e);return 3===s.length&&i(s[0],0,255)&&-1!==["issue","issuewild","iodef"].indexOf(s[1])&&/^"[\w-:./@]{1,255}"$/.test(s[2])})(e);case"SRV":return A(e);default:return!1}var t},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=validator.min.js.map
